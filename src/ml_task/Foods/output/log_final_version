生成数据列表完成！
---------------------------------------------------------------------------
 Layer (type)       Input Shape          Output Shape         Param #    
===========================================================================
   Conv2D-1      [[1, 3, 224, 224]]   [1, 64, 112, 112]        9,472     
 BatchNorm2D-1  [[1, 64, 112, 112]]   [1, 64, 112, 112]         256      
    ReLU-1      [[1, 64, 112, 112]]   [1, 64, 112, 112]          0       
  MaxPool2D-1   [[1, 64, 112, 112]]    [1, 64, 56, 56]           0       
   Conv2D-2      [[1, 64, 56, 56]]     [1, 64, 56, 56]        36,928     
 BatchNorm2D-2   [[1, 64, 56, 56]]     [1, 64, 56, 56]          256      
   Conv2D-3      [[1, 64, 56, 56]]     [1, 64, 56, 56]        36,928     
 BatchNorm2D-3   [[1, 64, 56, 56]]     [1, 64, 56, 56]          256      
  Residual-1     [[1, 64, 56, 56]]     [1, 64, 56, 56]           0       
   Conv2D-4      [[1, 64, 56, 56]]     [1, 64, 56, 56]        36,928     
 BatchNorm2D-4   [[1, 64, 56, 56]]     [1, 64, 56, 56]          256      
   Conv2D-5      [[1, 64, 56, 56]]     [1, 64, 56, 56]        36,928     
 BatchNorm2D-5   [[1, 64, 56, 56]]     [1, 64, 56, 56]          256      
  Residual-2     [[1, 64, 56, 56]]     [1, 64, 56, 56]           0       
   Conv2D-6      [[1, 64, 56, 56]]     [1, 64, 56, 56]        36,928     
 BatchNorm2D-6   [[1, 64, 56, 56]]     [1, 64, 56, 56]          256      
   Conv2D-7      [[1, 64, 56, 56]]     [1, 64, 56, 56]        36,928     
 BatchNorm2D-7   [[1, 64, 56, 56]]     [1, 64, 56, 56]          256      
  Residual-3     [[1, 64, 56, 56]]     [1, 64, 56, 56]           0       
   Conv2D-8      [[1, 64, 56, 56]]     [1, 128, 28, 28]       73,856     
 BatchNorm2D-8   [[1, 128, 28, 28]]    [1, 128, 28, 28]         512      
   Conv2D-9      [[1, 128, 28, 28]]    [1, 128, 28, 28]       147,584    
 BatchNorm2D-9   [[1, 128, 28, 28]]    [1, 128, 28, 28]         512      
   Conv2D-10     [[1, 64, 56, 56]]     [1, 128, 28, 28]        8,320     
  Residual-4     [[1, 64, 56, 56]]     [1, 128, 28, 28]          0       
   Conv2D-11     [[1, 128, 28, 28]]    [1, 128, 28, 28]       147,584    
BatchNorm2D-10   [[1, 128, 28, 28]]    [1, 128, 28, 28]         512      
   Conv2D-12     [[1, 128, 28, 28]]    [1, 128, 28, 28]       147,584    
BatchNorm2D-11   [[1, 128, 28, 28]]    [1, 128, 28, 28]         512      
  Residual-5     [[1, 128, 28, 28]]    [1, 128, 28, 28]          0       
   Conv2D-13     [[1, 128, 28, 28]]    [1, 128, 28, 28]       147,584    
BatchNorm2D-12   [[1, 128, 28, 28]]    [1, 128, 28, 28]         512      
   Conv2D-14     [[1, 128, 28, 28]]    [1, 128, 28, 28]       147,584    
BatchNorm2D-13   [[1, 128, 28, 28]]    [1, 128, 28, 28]         512      
  Residual-6     [[1, 128, 28, 28]]    [1, 128, 28, 28]          0       
   Conv2D-15     [[1, 128, 28, 28]]    [1, 128, 28, 28]       147,584    
BatchNorm2D-14   [[1, 128, 28, 28]]    [1, 128, 28, 28]         512      
   Conv2D-16     [[1, 128, 28, 28]]    [1, 128, 28, 28]       147,584    
BatchNorm2D-15   [[1, 128, 28, 28]]    [1, 128, 28, 28]         512      
  Residual-7     [[1, 128, 28, 28]]    [1, 128, 28, 28]          0       
   Conv2D-17     [[1, 128, 28, 28]]    [1, 256, 14, 14]       295,168    
BatchNorm2D-16   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
   Conv2D-18     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-17   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
   Conv2D-19     [[1, 128, 28, 28]]    [1, 256, 14, 14]       33,024     
  Residual-8     [[1, 128, 28, 28]]    [1, 256, 14, 14]          0       
   Conv2D-20     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-18   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
   Conv2D-21     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-19   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
  Residual-9     [[1, 256, 14, 14]]    [1, 256, 14, 14]          0       
   Conv2D-22     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-20   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
   Conv2D-23     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-21   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
  Residual-10    [[1, 256, 14, 14]]    [1, 256, 14, 14]          0       
   Conv2D-24     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-22   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
   Conv2D-25     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-23   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
  Residual-11    [[1, 256, 14, 14]]    [1, 256, 14, 14]          0       
   Conv2D-26     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-24   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
   Conv2D-27     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-25   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
  Residual-12    [[1, 256, 14, 14]]    [1, 256, 14, 14]          0       
   Conv2D-28     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-26   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
   Conv2D-29     [[1, 256, 14, 14]]    [1, 256, 14, 14]       590,080    
BatchNorm2D-27   [[1, 256, 14, 14]]    [1, 256, 14, 14]        1,024     
  Residual-13    [[1, 256, 14, 14]]    [1, 256, 14, 14]          0       
   Conv2D-30     [[1, 256, 14, 14]]     [1, 512, 7, 7]       1,180,160   
BatchNorm2D-28    [[1, 512, 7, 7]]      [1, 512, 7, 7]         2,048     
   Conv2D-31      [[1, 512, 7, 7]]      [1, 512, 7, 7]       2,359,808   
BatchNorm2D-29    [[1, 512, 7, 7]]      [1, 512, 7, 7]         2,048     
   Conv2D-32     [[1, 256, 14, 14]]     [1, 512, 7, 7]        131,584    
  Residual-14    [[1, 256, 14, 14]]     [1, 512, 7, 7]           0       
   Conv2D-33      [[1, 512, 7, 7]]      [1, 512, 7, 7]       2,359,808   
BatchNorm2D-30    [[1, 512, 7, 7]]      [1, 512, 7, 7]         2,048     
   Conv2D-34      [[1, 512, 7, 7]]      [1, 512, 7, 7]       2,359,808   
BatchNorm2D-31    [[1, 512, 7, 7]]      [1, 512, 7, 7]         2,048     
  Residual-15     [[1, 512, 7, 7]]      [1, 512, 7, 7]           0       
   Conv2D-35      [[1, 512, 7, 7]]      [1, 512, 7, 7]       2,359,808   
BatchNorm2D-32    [[1, 512, 7, 7]]      [1, 512, 7, 7]         2,048     
   Conv2D-36      [[1, 512, 7, 7]]      [1, 512, 7, 7]       2,359,808   
BatchNorm2D-33    [[1, 512, 7, 7]]      [1, 512, 7, 7]         2,048     
  Residual-16     [[1, 512, 7, 7]]      [1, 512, 7, 7]           0       
  AvgPool2D-1     [[1, 512, 7, 7]]      [1, 512, 3, 3]           0       
   Flatten-1      [[1, 512, 3, 3]]        [1, 4608]              0       
   Linear-1         [[1, 4608]]            [1, 512]          2,359,808   
   Linear-2          [[1, 512]]             [1, 5]             2,565     
===========================================================================
Total params: 23,668,997
Trainable params: 23,638,533
Non-trainable params: 30,464
---------------------------------------------------------------------------
Input size (MB): 0.57
Forward/backward pass size (MB): 73.96
Params size (MB): 90.29
Estimated Total Size (MB): 164.82
---------------------------------------------------------------------------

The loss value printed in the log is the current step, and the metric is the average value of previous steps.
Epoch 1/30
step 69/69 - loss: 1.4683 - acc: 0.2654 - 231ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/0
Eval begin...
step 10/10 - loss: 1.3702 - acc: 0.3760 - 227ms/step
Eval samples: 625
Epoch 2/30
step 69/69 - loss: 1.1607 - acc: 0.4027 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/1
Eval begin...
step 10/10 - loss: 1.1938 - acc: 0.5008 - 226ms/step
Eval samples: 625
Epoch 3/30
step 69/69 - loss: 1.4295 - acc: 0.4958 - 226ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/2
Eval begin...
step 10/10 - loss: 1.1771 - acc: 0.5184 - 226ms/step
Eval samples: 625
Epoch 4/30
step 69/69 - loss: 1.2979 - acc: 0.5374 - 226ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/3
Eval begin...
step 10/10 - loss: 1.1886 - acc: 0.5120 - 226ms/step
Eval samples: 625
Epoch 5/30
step 69/69 - loss: 0.8227 - acc: 0.5794 - 227ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/4
Eval begin...
step 10/10 - loss: 1.1351 - acc: 0.5376 - 228ms/step
Eval samples: 625
Epoch 6/30
step 69/69 - loss: 0.8861 - acc: 0.6247 - 227ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/5
Eval begin...
step 10/10 - loss: 1.1115 - acc: 0.5888 - 226ms/step
Eval samples: 625
Epoch 7/30
step 69/69 - loss: 0.8744 - acc: 0.6491 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/6
Eval begin...
step 10/10 - loss: 0.9900 - acc: 0.5840 - 226ms/step
Eval samples: 625
Epoch 8/30
step 69/69 - loss: 0.9706 - acc: 0.6873 - 227ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/7
Eval begin...
step 10/10 - loss: 0.9520 - acc: 0.5904 - 228ms/step
Eval samples: 625
Epoch 9/30
step 69/69 - loss: 0.6386 - acc: 0.7237 - 227ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/8
Eval begin...
step 10/10 - loss: 1.0933 - acc: 0.5424 - 227ms/step
Eval samples: 625
Epoch 10/30
step 69/69 - loss: 1.0640 - acc: 0.7520 - 227ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/9
Eval begin...
step 10/10 - loss: 0.9465 - acc: 0.5904 - 226ms/step
Eval samples: 625
Epoch 11/30
step 69/69 - loss: 0.8395 - acc: 0.7979 - 227ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/10
Eval begin...
step 10/10 - loss: 1.4642 - acc: 0.5760 - 227ms/step
Eval samples: 625
Epoch 12/30
step 69/69 - loss: 0.5206 - acc: 0.8320 - 227ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/11
Eval begin...
step 10/10 - loss: 1.1506 - acc: 0.5312 - 226ms/step
Eval samples: 625
Epoch 13/30
step 69/69 - loss: 0.2935 - acc: 0.8729 - 227ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/12
Eval begin...
step 10/10 - loss: 1.7201 - acc: 0.5264 - 226ms/step
Eval samples: 625
Epoch 14/30
step 69/69 - loss: 0.5466 - acc: 0.8898 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/13
Eval begin...
step 10/10 - loss: 1.2596 - acc: 0.5632 - 226ms/step
Eval samples: 625
Epoch 15/30
step 69/69 - loss: 0.2827 - acc: 0.8946 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/14
Eval begin...
step 10/10 - loss: 1.6032 - acc: 0.5824 - 226ms/step
Eval samples: 625
Epoch 16/30
step 69/69 - loss: 0.4590 - acc: 0.9042 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/15
Eval begin...
step 10/10 - loss: 1.4786 - acc: 0.5312 - 226ms/step
Eval samples: 625
Epoch 17/30
step 69/69 - loss: 0.2383 - acc: 0.9406 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/16
Eval begin...
step 10/10 - loss: 2.3673 - acc: 0.5504 - 226ms/step
Eval samples: 625
Epoch 18/30
step 69/69 - loss: 0.3355 - acc: 0.9275 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/17
Eval begin...
step 10/10 - loss: 1.6788 - acc: 0.5872 - 226ms/step
Eval samples: 625
Epoch 19/30
step 69/69 - loss: 0.3862 - acc: 0.9406 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/18
Eval begin...
step 10/10 - loss: 2.1764 - acc: 0.5632 - 226ms/step
Eval samples: 625
Epoch 20/30
step 69/69 - loss: 0.2513 - acc: 0.9666 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/19
Eval begin...
step 10/10 - loss: 1.3967 - acc: 0.5936 - 227ms/step
Eval samples: 625
Epoch 21/30
step 69/69 - loss: 0.2451 - acc: 0.9703 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/20
Eval begin...
step 10/10 - loss: 1.5555 - acc: 0.5792 - 226ms/step
Eval samples: 625
Epoch 22/30
step 69/69 - loss: 0.3818 - acc: 0.9650 - 228ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/21
Eval begin...
step 10/10 - loss: 1.7111 - acc: 0.5456 - 227ms/step
Eval samples: 625
Epoch 23/30
step 69/69 - loss: 0.2418 - acc: 0.9344 - 227ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/22
Eval begin...
step 10/10 - loss: 1.5719 - acc: 0.5552 - 225ms/step
Eval samples: 625
Epoch 24/30
step 69/69 - loss: nan - acc: 0.3246 - 226ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/23
Eval begin...
step 10/10 - loss: nan - acc: 0.2000 - 225ms/step
Eval samples: 625
Epoch 25/30
step 69/69 - loss: nan - acc: 0.2000 - 225ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/24
Eval begin...
step 10/10 - loss: nan - acc: 0.2000 - 224ms/step
Eval samples: 625
Epoch 26/30
step 69/69 - loss: nan - acc: 0.2000 - 225ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/25
Eval begin...
step 10/10 - loss: nan - acc: 0.2000 - 224ms/step
Eval samples: 625
Epoch 27/30
step 69/69 - loss: nan - acc: 0.2000 - 226ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/26
Eval begin...
step 10/10 - loss: nan - acc: 0.2000 - 225ms/step
Eval samples: 625
Epoch 28/30
step 69/69 - loss: nan - acc: 0.2000 - 225ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/27
Eval begin...
step 10/10 - loss: nan - acc: 0.2000 - 225ms/step
Eval samples: 625
Epoch 29/30
step 69/69 - loss: nan - acc: 0.2000 - 225ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/28
Eval begin...
step 10/10 - loss: nan - acc: 0.2000 - 227ms/step
Eval samples: 625
Epoch 30/30
step 69/69 - loss: nan - acc: 0.2000 - 226ms/step
save checkpoint at /home/roots/ruiqingluo/model/final_version/29
Eval begin...
step 10/10 - loss: nan - acc: 0.2000 - 226ms/step
Eval samples: 625
save checkpoint at /home/roots/ruiqingluo/model/final_version/final
Eval begin...
step 10/10 [==============================] - loss: nan - acc: 0.2000 - 227ms/step
Eval samples: 625
{'loss': [nan], 'acc': 0.2}
