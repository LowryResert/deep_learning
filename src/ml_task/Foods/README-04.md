# 作业04：美食分类

姓名：罗睿卿

学号：21214935

## 说明

- 在本次作业中，我使用了paddle 2.1.3 版本，没有使用作业中默认的paddle 1.8版本。

- 最终的代码和训练过程中的log已经均已上传，notebook中的模型代码已用paddle 2.1 版本的api补全。

- 由于模型大小超过150M，aistudio平台限制，故无法上传训练得到的完整模型。

## 模型对比

我使用给出的数据集在**自定义网络MyNet（包括LeNet、VGG、ResNet的改进型）、VGG、ResNet**中分别进行了训练。在表中分别列出了具体的模型和训练中的各项超参数，以及训练得到的模型在测试集上的loss和acc。

在测试数据集中以及所有模型和不同的超参数设置下，accuracy最高的是**经过预训练的ResNet50**，loss最高的是**未经过预训练的ResNet101**。

|network|batch_size|lr|epoch|pretrained|eval_loss|eval_acc|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|MyLeNetv1|64|0.01|10|False|1.2919581|0.5152|
|MyLeNetv1|64|0.01|50|False|1.2832452|0.5274|
|MyVGGNetv2|64|0.001|50|False|1.1486477|0.5618|
|**MyResNetv3**|64|0.001|50|False|1.2279282|0.7684|
|VGG11|64|0.001|50|False|1.608978|0.52|
|VGG16|32|0.001|50|False|0.6164053|0.6096|
|ResNet34|64|0.001|50|False|1.121083|0.7472|
|**ResNet34**|64|0.001|50|**True**|1.2864718|0.8016|
|ResNet50|64|0.001|30|False|2.1636353|0.6528|
|ResNet50|64|0.001|50|False|1.0249695|0.6832|
|**ResNet50**|64|0.001|50|**True**|1.4189456|**0.8304**|
|ResNet101|64|0.001|10|False|**0.8664999**|0.5648|
|ResNet101|64|0.001|50|False|1.5984339|0.5808|
|ResNet101|64|0.001|50|**True**|1.2499|0.7808|

## 结果分析

**综合来看以下模型在测试集中的表现最好：**

- **在经过预训练的情况下，表现最好的是ResNet50，acc达到了83.04%；**
- **在未经过预训练的情况下，表现最好的是ResNet34，acc达到了80.16%。**

自定义模型：

- MyNetv1是通过改进LeNet的自定义模型，使用不同的超参数设置，经过几轮的测试，acc稳定在52%左右；
- MyNetv2是通过改进VGGNet的自定义模型，acc稳定在56%左右；
- MyNetv3是通过改进ResNet34的自定义模型，acc稳定在77%左右。